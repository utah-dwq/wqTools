#' Read daily Utah Lake gage heights 
#'
#' This function reads Utah Lake gage heights and interprets them to elevations and surface area and volume estimates. Surface area 
#' and volume estimates are based on curves developed by James Martin and Scott Daly. Gage heights are read from Utah Division of 
#' Water Rights https://www.waterrights.utah.gov/cgi-bin/dvrtview.exe?STATION_ID=9019&RECORD_YEAR=2020&Modinfo=Daily_Comma&Startup.
#' @param cap_curve One of 'lidar' (default) or 'udwr' to select the capacity curve used for surface area and volume estimates. Capacity curves are stored 
#' within the function as dput dataframes. These can be exported and used outside of this function via the cap_curve_only argument (see below).
#' @param cap_curve_only Logical. If TRUE, returns only the selected capacity curve. Default is FALSE.
#' @importFrom data.table setkey
#' @importFrom data.table data.table
#' @import dplyr
#' @return Returns a dataframe of daily gage heights, lake elevations, and surface area and volume estimates.
#' @examples
#' ul_elev=readULgageheight()
#' head(ul_elev)
#' cap_curve_lidar=readULgageheight(cap_curve_only=T)
#' head(cap_curve_lidar)
#' @export
readULgageheight=function(cap_curve="lidar", cap_curve_only=FALSE){
	# Capacity curves
		cap_udwr=structure(list(stage_m = c(1364.2848, 1364.30004, 1364.31528, 
		1364.33052, 1364.34576, 1364.361, 1364.37624, 1364.39148, 1364.40672, 
		1364.42196, 1364.4372, 1364.45244, 1364.46768, 1364.48292, 1364.49816, 
		1364.5134, 1364.52864, 1364.54388, 1364.55912, 1364.57436, 1364.5896, 
		1364.60484, 1364.62008, 1364.63532, 1364.65056, 1364.6658, 1364.68104, 
		1364.69628, 1364.71152, 1364.72676, 1364.742, 1364.75724, 1364.77248, 
		1364.78772, 1364.80296, 1364.8182, 1364.83344, 1364.84868, 1364.86392, 
		1364.87916, 1364.8944, 1364.90964, 1364.92488, 1364.94012, 1364.95536, 
		1364.9706, 1364.98584, 1365.00108, 1365.01632, 1365.03156, 1365.0468, 
		1365.06204, 1365.07728, 1365.09252, 1365.10776, 1365.123, 1365.13824, 
		1365.15348, 1365.16872, 1365.18396, 1365.1992, 1365.21444, 1365.22968, 
		1365.24492, 1365.26016, 1365.2754, 1365.29064, 1365.30588, 1365.32112, 
		1365.33636, 1365.3516, 1365.36684, 1365.38208, 1365.39732, 1365.41256, 
		1365.4278, 1365.44304, 1365.45828, 1365.47352, 1365.48876, 1365.504, 
		1365.51924, 1365.53448, 1365.54972, 1365.56496, 1365.5802, 1365.59544, 
		1365.61068, 1365.62592, 1365.64116, 1365.6564, 1365.67164, 1365.68688, 
		1365.70212, 1365.71736, 1365.7326, 1365.74784, 1365.76308, 1365.77832, 
		1365.79356, 1365.8088, 1365.82404, 1365.83928, 1365.85452, 1365.86976, 
		1365.885, 1365.90024, 1365.91548, 1365.93072, 1365.94596, 1365.9612, 
		1365.97644, 1365.99168, 1366.00692, 1366.02216, 1366.0374, 1366.05264, 
		1366.06788, 1366.08312, 1366.09836, 1366.1136, 1366.12884, 1366.14408, 
		1366.15932, 1366.17456, 1366.1898, 1366.20504, 1366.22028, 1366.23552, 
		1366.25076, 1366.266, 1366.28124, 1366.29648, 1366.31172, 1366.32696, 
		1366.3422, 1366.35744, 1366.37268, 1366.38792, 1366.40316, 1366.4184, 
		1366.43364, 1366.44888, 1366.46412, 1366.47936, 1366.4946, 1366.50984, 
		1366.52508, 1366.54032, 1366.55556, 1366.5708, 1366.58604, 1366.60128, 
		1366.61652, 1366.63176, 1366.647, 1366.66224, 1366.67748, 1366.69272, 
		1366.70796, 1366.7232, 1366.73844, 1366.75368, 1366.76892, 1366.78416, 
		1366.7994, 1366.81464, 1366.82988, 1366.84512, 1366.86036, 1366.8756, 
		1366.89084, 1366.90608, 1366.92132, 1366.93656, 1366.9518, 1366.96704, 
		1366.98228, 1366.99752, 1367.01276, 1367.028, 1367.04324, 1367.05848, 
		1367.07372, 1367.08896, 1367.1042, 1367.11944, 1367.13468, 1367.14992, 
		1367.16516, 1367.1804, 1367.19564, 1367.21088, 1367.22612, 1367.24136, 
		1367.2566, 1367.27184, 1367.28708, 1367.30232, 1367.31756, 1367.3328, 
		1367.34804, 1367.36328, 1367.37852, 1367.39376, 1367.409, 1367.42424, 
		1367.43948, 1367.45472, 1367.46996, 1367.4852, 1367.50044, 1367.51568, 
		1367.53092, 1367.54616, 1367.5614, 1367.57664, 1367.59188, 1367.60712, 
		1367.62236, 1367.6376, 1367.65284, 1367.66808, 1367.68332, 1367.69856, 
		1367.7138, 1367.72904, 1367.74428, 1367.75952, 1367.77476, 1367.79, 
		1367.80524, 1367.82048, 1367.83572, 1367.85096, 1367.8662, 1367.88144, 
		1367.89668, 1367.91192, 1367.92716, 1367.9424, 1367.95764, 1367.97288, 
		1367.98812, 1368.00336, 1368.0186, 1368.03384, 1368.04908, 1368.06432, 
		1368.07956, 1368.0948, 1368.11004, 1368.12528, 1368.14052, 1368.15576, 
		1368.171, 1368.18624, 1368.20148, 1368.21672, 1368.23196, 1368.2472, 
		1368.26244, 1368.27768, 1368.29292, 1368.30816, 1368.3234, 1368.33864, 
		1368.35388, 1368.36912, 1368.38436, 1368.3996, 1368.41484, 1368.43008, 
		1368.44532, 1368.46056, 1368.4758, 1368.49104, 1368.50628, 1368.52152, 
		1368.53676, 1368.552, 1368.56724, 1368.58248, 1368.59772, 1368.61296, 
		1368.6282, 1368.64344, 1368.65868, 1368.67392, 1368.68916, 1368.7044, 
		1368.71964, 1368.73488, 1368.75012, 1368.76536, 1368.7806, 1368.79584, 
		1368.81108, 1368.82632, 1368.84156, 1368.8568, 1368.87204, 1368.88728, 
		1368.90252, 1368.91776, 1368.933, 1368.94824, 1368.96348, 1368.97872, 
		1368.99396, 1369.0092, 1369.02444, 1369.03968, 1369.05492, 1369.07016, 
		1369.0854, 1369.10064, 1369.11588, 1369.13112, 1369.14636, 1369.1616, 
		1369.17684, 1369.19208, 1369.20732, 1369.22256, 1369.2378, 1369.25304, 
		1369.26828, 1369.28352, 1369.29876, 1369.314, 1369.32924, 1369.34448, 
		1369.35972, 1369.37496, 1369.3902, 1369.40544, 1369.42068, 1369.43592, 
		1369.45116, 1369.4664, 1369.48164, 1369.49688, 1369.51212, 1369.52736, 
		1369.5426, 1369.55784), volume_m3 = c(0, 4317.18, 8634.36, 28370.04, 
		48105.72, 107929.5, 167753.28, 303436.08, 439118.88, 700616.64, 
		962114.4, 1395065.88, 1828017.36, 2427488.64, 3026959.92, 3780616.2, 
		4534272.48, 5434096.14, 6333919.8, 7370659.74, 8407399.68, 9575505.24, 
		10743610.8, 12036914.58, 13330218.36, 14742552.96, 16154887.56, 
		17682552.54, 19210217.52, 20848895.7, 22487573.88, 24234181.56, 
		25980789.24, 27830392.5, 29679995.76, 31630744.38, 33581493, 
		35630303.28, 37679113.56, 39823518.54, 41967923.52, 44236293.24, 
		46504662.96, 48919816.8, 51334970.64, 53883957.06, 56432943.48, 
		59107128.12, 61781312.76, 64570211.04, 67359109.32, 70254703.62, 
		73150297.92, 76145187.36, 79140076.8, 82228710.72, 85317344.64, 
		88492322.16, 91667299.68, 94924303.62, 98181307.56, 101515404, 
		104849500.4, 108255755.5, 111662010.5, 115136106.9, 118610203.3, 
		122149057.4, 125687911.6, 129287822.9, 132887734.3, 136545619.3, 
		140203504.2, 143916895.7, 147630287.3, 151395485, 155160682.7, 
		158975836.3, 162790990, 166653632.6, 170516275.2, 174424556.6, 
		178332838, 182284291.1, 186235744.3, 190228519.1, 194221293.8, 
		198254156.7, 202287019.6, 206358120.3, 210429221, 214536092.7, 
		218642964.4, 222785606.9, 226928249.5, 231104196.1, 235280142.6, 
		239488776.4, 243697410.1, 247937497.6, 252177585.1, 256447892.9, 
		260718200.6, 265016878.4, 269315556.2, 273642604.1, 277969651.9, 
		282323836.3, 286678020.7, 291058108.2, 295438195.7, 299843569.5, 
		304248943.3, 308678370, 313107796.7, 317561276.2, 322014755.8, 
		326491054.7, 330967353.6, 335465855.2, 339964356.7, 344485060.9, 
		349005765.1, 353548672, 358091578.8, 362656071.5, 367220564.3, 
		371807259.7, 376393955, 381002853.1, 385611751.1, 390242235, 
		394872718.9, 399524788.7, 404176858.6, 408850514.3, 413524170, 
		418219411.6, 422914653.2, 427630864, 432347074.8, 437084871.5, 
		441822668.2, 446581434, 451340199.8, 456119934.8, 460899669.8, 
		465700990.7, 470502311.6, 475323985, 480145658.3, 484988300.8, 
		489830943.2, 494694554.9, 499558166.5, 504441513.8, 509324861.2, 
		514229794.4, 519134727.6, 524059396.5, 528984065.4, 533929703.5, 
		538875341.5, 543840715.3, 548806089, 553791815.2, 558777541.3, 
		563783619.9, 568789698.5, 573816129.5, 578842560.5, 583888110.4, 
		588933660.4, 593999562.7, 599065465.1, 604151719.9, 609237974.6, 
		614343348.4, 619448722.1, 624573831.5, 629698940.9, 634843786, 
		639988631, 645153211.8, 650317792.6, 655502109, 660685192, 665889244.1, 
		671092062.7, 676314617, 681537171.4, 686779461.4, 692021751.4, 
		697282543.6, 702544569.2, 707823863.6, 713104391.5, 718404655.1, 
		723703685.2, 729022450.9, 734341216.7, 739676017.7, 745010818.7, 
		750360421.4, 755711257.7, 761075662.2, 766440066.7, 771819273, 
		777197245.8, 782591253.8, 787985261.9, 793394071.7, 798804115, 
		804227726.5, 809651338.1, 815090984.9, 820529398.2, 825983846.8, 
		831438295.3, 836908779.1, 842378029.4, 847863315, 853348600.6, 
		858849921.4, 864351242.2, 869867364.7, 875384720.8, 880916878.6, 
		886449036.4, 891997229.4, 897545422.4, 903109650.7, 908675112.5, 
		914255376, 919835639.5, 925431938.3, 931029470.5, 936641804.5, 
		942255372, 947884974.7, 953514577.4, 959160215.4, 964807086.8, 
		970468760, 976131666.7, 981811842.1, 987490784, 993186994.7, 
		998884438.8, 1004596685, 1010310164, 1016040912, 1021771660, 
		1027519677, 1033266460, 1039031746, 1044797031, 1050578352, 1056360906, 
		1062160729, 1067960552, 1073777644, 1079594736, 1085430330, 1091265923, 
		1097118786, 1102971649, 1108841780, 1114713145, 1120601778, 1126490412, 
		1132397547, 1138303450, 1144229088, 1150153492, 1156097632, 1162040539, 
		1168003181, 1173964590, 1179944501, 1186808027, 1193671552, 1200535078, 
		1207398603, 1214262129, 1221125654, 1227989180, 1234590132, 1240140792, 
		1245691452, 1251242112, 1256792772, 1262343432, 1267894092, 1273444752, 
		1278995412, 1284546072, 1290096732, 1295647392, 1301198052, 1306748712, 
		1312299372, 1317850032, 1323400692, 1328951352, 1334502012, 1340052672, 
		1345726680, 1351894080, 1358061480, 1364228880, 1370396280, 1376563680, 
		1382731080, 1388898480, 1395065880, 1401233280, 1407400680, 1413568080, 
		1419735480, 1425902880, 1432070280, 1438237680, 1444405080, 1450572480, 
		1456739880, 1462907280, 1469198028, 1475982168, 1482766308, 1489550448, 
		1496334588, 1503118728, 1509902868, 1516687008, 1523471148, 1530255288, 
		1537039428, 1543823568, 1550607708, 1557391848, 1564175988, 1570960128, 
		1577744268, 1584528408, 1591312548, 1598096688), surface_area_m2 = c(60702.84634, 
		329818.7984, 598934.7505, 1444727.743, 2290520.735, 4111606.125, 
		5932691.515, 9168153.225, 12403614.93, 17530982.02, 22658349.11, 
		28327994.96, 33997640.8, 39252483.87, 44507326.93, 49426280.91, 
		54345234.9, 58982932.36, 63620629.82, 68017539.32, 72414448.82, 
		76604968.65, 80795488.47, 84805923.19, 88816357.9, 92666941.79, 
		96517525.67, 100226469.6, 103935413.5, 107512834.6, 111090255.7, 
		114554364.7, 118018473.8, 121375341.2, 124732208.7, 127991951.5, 
		131251694.3, 134420382.9, 137589071.5, 140676823, 143764574.4, 
		148776606.1, 153788637.8, 158389913.5, 162991189.3, 167232294.8, 
		171473400.3, 175394804.2, 179316208.1, 182952308.6, 186588409.1, 
		189969557.6, 193350706.1, 196505230.7, 199659755.3, 202609913.6, 
		205560072, 208326098.3, 211092124.7, 213688183.1, 216284241.5, 
		218728542.8, 221172844.1, 223475505.4, 225778166.7, 227955375.4, 
		230132584.2, 232192434.1, 234252284, 236202868.8, 238153453.6, 
		240006913.8, 241860374.1, 243620756.6, 245381139.2, 247056537.7, 
		248731936.3, 250328421.1, 251924906, 253448547.5, 254972188.9, 
		256427033.8, 257881878.7, 259273997.3, 260666115.9, 261997531.6, 
		263328947.4, 264605730.6, 265882513.8, 267104664.4, 268326815.1, 
		269502426.9, 270678038.7, 271807111.6, 272936184.6, 274020742.1, 
		275105299.6, 276149388.6, 277193477.5, 278199121.3, 279204765.2, 
		280176010.7, 281147256.2, 282082080.1, 283016903.9, 283919352.9, 
		284821801.9, 285693899.4, 286565997, 287407743.1, 288249489.3, 
		289062907.4, 289876325.5, 290665462.5, 291454599.5, 292217432, 
		292980264.4, 293718815.7, 294457367, 295173660.6, 295889954.2, 
		296620411.8, 297350869.3, 298077280.1, 298803690.8, 299528078.1, 
		300252465.4, 300970782.4, 301689099.4, 302405393, 303121686.6, 
		303833933.3, 304546180.1, 305254379.9, 305962579.8, 306668756.3, 
		307374932.7, 308077062.3, 308779191.9, 309479298, 310179404.2, 
		310875463.5, 311571522.8, 312263535.3, 312955547.7, 313645536.7, 
		314335525.8, 315021467.9, 315707410.1, 316391328.8, 317075247.6, 
		317757142.9, 318439038.2, 319116886.6, 319794735.1, 320470560.1, 
		321146385.1, 321818163.3, 322489941.4, 323159696.2, 323829450.9, 
		324497182.2, 325164913.5, 325828598, 326492282.4, 327153943.5, 
		327815604.5, 328475242.1, 329134879.7, 329792493.9, 330450108, 
		331103675.3, 331757242.7, 332410810, 333064377.3, 333713897.7, 
		334363418.2, 335010915.2, 335658412.2, 336301862.4, 336945312.6, 
		337588762.8, 338232212.9, 338871616.2, 339515066.4, 340150422.9, 
		340789826.2, 341425182.6, 342064586, 342695895.6, 343331252, 
		343962561.6, 344593871.2, 345225180.8, 345852443.6, 346479706.3, 
		347111015.9, 347734231.8, 348361494.6, 348984710.4, 349607926.3, 
		350081408.5, 350558937.6, 351036466.6, 351513995.7, 351995571.6, 
		352477147.5, 352962770.3, 353448393.1, 353938062.7, 354423685.5, 
		354917402, 355411118.4, 355904834.9, 356402598.3, 356900361.6, 
		357402171.8, 357903982, 358405792.2, 358915696.1, 359421553.2, 
		359931457.1, 360441361, 360955311.7, 361469262.5, 361983213.3, 
		362501210.9, 363023255.4, 363541253, 364067344.3, 364589388.8, 
		365119527, 365645618.3, 366175756.5, 366705894.7, 367244126.6, 
		367778311.7, 368316543.6, 368850728.6, 369393007.4, 369935286.1, 
		370481611.8, 371023890.5, 371574263, 372120588.6, 372675007.9, 
		373225380.4, 373779799.7, 374334219.1, 374892685.3, 375451151.4, 
		376013664.5, 376576177.5, 377142737.4, 377705250.5, 378275857.2, 
		378842417.1, 379417070.7, 379987677.5, 380562331.1, 381136984.7, 
		381719732, 382298432.5, 382877133, 383459880.3, 384046674.5, 
		384633468.7, 385220262.8, 385811103.9, 386401944.9, 386996832.8, 
		387591720.7, 388186608.6, 388785543.4, 389384478.1, 389987459.7, 
		390590441.3, 391193422.9, 391800451.4, 392411526.7, 393022602, 
		393633677.4, 394244752.7, 394855828, 395466903.3, 396077978.6, 
		396689053.9, 397300129.3, 397911204.6, 398522279.9, 399133355.2, 
		399744430.5, 400355505.9, 400966581.2, 401577656.5, 402188731.8, 
		402799807.1, 403410882.5, 404021957.8, 404633033.1, 405244108.4, 
		405855183.7, 406466259.1, 407077334.4, 407688409.7, 408299485, 
		408910560.3, 409521635.7, 410132711, 410743786.3, 411354861.6, 
		411965936.9, 412577012.3, 413188087.6, 413799162.9, 414410238.2, 
		415021313.5, 415632388.9, 416243464.2, 416854539.5, 417465614.8, 
		418076690.1, 418687765.5, 419298840.8, 419909916.1, 420520991.4, 
		421132066.7, 421743142.1, 422354217.4, 422965292.7, 423576368, 
		424187443.3, 424798518.7, 425409594, 426020669.3, 426631744.6, 
		427242819.9, 427853895.3, 428464970.6, 429076045.9, 429687121.2, 
		430298196.5, 430909271.9, 431520347.2, 432131422.5, 432742497.8, 
		433353573.1)), class = "data.frame", row.names = c(NA, -347L))
	
		cap_lidar=structure(list(stage_m = c(1364.06, 1364.09, 1364.12, 1364.15, 
		1364.18, 1364.21, 1364.24, 1364.27, 1364.3, 1364.33, 1364.36, 
		1364.39, 1364.42, 1364.46, 1364.49, 1364.52, 1364.55, 1364.58, 
		1364.61, 1364.64, 1364.67, 1364.7, 1364.73, 1364.76, 1364.79, 
		1364.82, 1364.85, 1364.88, 1364.91, 1364.94, 1364.97, 1365, 1365.03, 
		1365.06, 1365.09, 1365.12, 1365.15, 1365.18, 1365.22, 1365.25, 
		1365.28, 1365.31, 1365.34, 1365.37, 1365.4, 1365.43, 1365.46, 
		1365.49, 1365.52, 1365.55, 1365.58, 1365.61, 1365.64, 1365.67, 
		1365.7, 1365.73, 1365.76, 1365.79, 1365.82, 1365.85, 1365.88, 
		1365.91, 1365.94, 1365.98, 1366.01, 1366.04, 1366.07, 1366.1, 
		1366.13, 1366.16, 1366.19, 1366.22, 1366.25, 1366.28, 1366.31, 
		1366.34, 1366.37, 1366.4, 1366.43, 1366.46, 1366.49, 1366.52, 
		1366.55, 1366.58, 1366.61, 1366.64, 1366.67, 1366.7, 1366.74, 
		1366.77, 1366.8, 1366.83, 1366.86, 1366.89, 1366.92, 1366.95, 
		1366.98, 1367.01, 1367.04, 1367.07, 1367.1, 1367.13, 1367.16, 
		1367.19, 1367.22, 1367.25, 1367.28, 1367.31, 1367.34, 1367.37, 
		1367.4, 1367.43, 1367.46, 1367.5, 1367.53, 1367.56, 1367.59, 
		1367.62, 1367.65, 1367.68, 1367.71, 1367.74, 1367.77, 1367.8, 
		1367.83, 1367.86, 1367.89, 1367.92, 1367.95, 1367.98, 1368.01, 
		1368.04, 1368.07, 1368.1, 1368.13, 1368.16, 1368.19, 1368.22, 
		1368.26, 1368.29, 1368.32, 1368.35, 1368.38, 1368.41, 1368.44, 
		1368.47, 1368.5, 1368.53, 1368.56, 1368.59, 1368.62, 1368.65, 
		1368.68, 1368.71, 1368.74, 1368.77, 1368.8, 1368.83, 1368.86, 
		1368.89, 1368.92, 1368.95, 1368.98, 1369.02, 1369.05, 1369.08, 
		1369.11, 1369.14, 1369.17, 1369.2, 1369.23, 1369.26, 1369.29, 
		1369.32, 1369.35, 1369.38, 1369.41, 1369.44, 1369.47, 1369.5, 
		1369.53, 1369.56, 1369.59, 1369.62, 1369.65, 1369.68, 1369.71, 
		1369.74, 1369.78, 1369.81, 1369.84, 1369.87, 1369.9, 1369.93, 
		1369.96), volume_m3 = c(0, 474.94, 2896.94, 9168.88, 20820.94, 
		44686.66, 84736.77, 154766.77, 308839.28, 560192.93, 923565.66, 
		1430272.27, 2133927.19, 3138712.17, 4471308.12, 6025780.43, 7807211.61, 
		9823008.72, 12098900.04, 14636818.24, 17376005.75, 20296598.19, 
		23392517.46, 26665570.12, 30131468.03, 33807547, 37711226.44, 
		41869411.76, 46405102.1, 51287093.1, 56399432.14, 61708045.87, 
		67201611.74, 72876742.33, 78725600.83, 84738582.39, 90912696.3, 
		97243576.87, 103724177.31, 110352622.84, 117124301.77, 124063372.42, 
		131113331.63, 138290014.81, 145586012.42, 152996229.07, 160508713.77, 
		168115178.71, 175832873.05, 183672156.52, 191609708.67, 199634577.91, 
		207740295.58, 215916700.18, 224158640.32, 232463147.22, 240828552.06, 
		249248745.25, 257718563.79, 266232149.24, 274784624.89, 283370989.23, 
		291990808.08, 300639475.4, 309314973.56, 318016797.27, 326742969.29, 
		335492409.42, 344309599.98, 353124642.68, 361969744.35, 370852049.95, 
		379784371, 388778707.24, 397836938.54, 406949717.93, 416113710.41, 
		425328132.01, 434594218.74, 443910340.32, 453273183.98, 462683788.06, 
		472140078.05, 481641963.12, 491189596.68, 500782807.12, 510418339.7, 
		520099925.77, 529849735.3, 539664021.3, 549531461.46, 559453323.98, 
		569423889.32, 579437818.74, 589487701.16, 599566692.51, 609714657.09, 
		619853433.06, 630024870.79, 640227534.05, 650455703.61, 660706467.4, 
		670979335.78, 681274915.28, 691593222.97, 701934627.11, 712298813.62, 
		722685230.95, 733094771.88, 743528021.48, 753985912.4, 764469571.62, 
		774979766.11, 785518175.61, 796086035.88, 806685393.64, 817319780.03, 
		827992479.57, 838705253.6, 849457379.88, 860246480.16, 871071942.22, 
		881934544.42, 892877172.14, 903812233.34, 914787399.37, 925800504.93, 
		936850148.39, 947936515.69, 959060490.28, 970222096.08, 981420598.76, 
		992656028.83, 1003928500.32, 1015241291.93, 1026595384, 1037987259.17, 
		1049415198.01, 1060878439.1, 1072377619.08, 1083913119.58, 1095486072.88, 
		1107098329.16, 1118751323.63, 1130444368.59, 1142177492.1, 1153950981.85, 
		1165765819.71, 1177621015.34, 1189514357.1, 1201492395.36, 1213458274.71, 
		1225459154.42, 1237495416.42, 1249565257.67, 1261670968.35, 1273809087.48, 
		1285979768.53, 1298182822.51, 1310417400.5, 1322683132.23, 1334979713.35, 
		1347306215.36, 1359661478.59, 1372044923.46, 1384455345.19, 1396893562.44, 
		1409357453.44, 1421845697.33, 1434357982.58, 1446894940.6, 1459456080.48, 
		1472040745.86, 1484650164.75, 1497283956.86, 1509939837.82, 1522619220.74, 
		1535376790.38, 1548112987.89, 1560877143.7, 1573666153.16, 1586478500.92, 
		1599313691.36, 1612172178.53, 1625054391.69, 1637961052.23, 1650893352.56, 
		1663852185.07, 1676837823.14, 1689848049.21, 1702882219.74, 1715940383.52, 
		1729022746.08, 1742128856.47, 1755257744.38), surface_area_m2 = c(0, 
		33900, 138900, 278700, 548800, 1031200, 1619500, 3347500, 6622400, 
		10000100, 14045300, 19582900, 27106300, 39698500, 47401300, 54830400, 
		62408000, 70168300, 79846800, 86921400, 93179700, 98953900, 104721100, 
		110709800, 117422300, 124532100, 132464500, 141272000, 156205100, 
		164660400, 171528000, 177734400, 183707600, 189607300, 195166500, 
		200450200, 205748600, 210781800, 215645300, 220472600, 225067800, 
		229701700, 234105000, 238089900, 241955700, 245546700, 248724800, 
		251795500, 256124000, 259591500, 262596400, 265389800, 267845600, 
		270098400, 272197100, 274216400, 276133500, 277879000, 279407100, 
		280771300, 281929000, 283070000, 284078400, 284990300, 285865400, 
		286680100, 287483400, 288315500, 289524600, 290480900, 291549900, 
		292967300, 294835500, 296999700, 298948700, 300638900, 302318200, 
		303982500, 305689500, 307251200, 308780900, 310350000, 311829600, 
		313330500, 314836600, 316314900, 317699300, 319575300, 321974000, 
		323756100, 325579300, 327266800, 328782500, 330094900, 331142100, 
		332047300, 333026000, 334110200, 335172400, 336100000, 336881300, 
		337603500, 338338600, 339090100, 339839400, 340601300, 341331600, 
		342077700, 342841800, 343628200, 344463600, 345348300, 346247400, 
		347208100, 348193800, 349284100, 350495200, 351798900, 353115000, 
		354364100, 355553300, 356776100, 357978600, 359152600, 360366600, 
		361696100, 362915500, 364110000, 365325500, 366566300, 367788700, 
		368993600, 370196500, 371432200, 372796500, 374104100, 375463300, 
		376628100, 377794900, 378985400, 380183500, 381439700, 382762900, 
		384086100, 385391900, 386702700, 388039000, 389386500, 390665600, 
		391887400, 393074200, 394230700, 395362800, 396525200, 397581000, 
		398768800, 399811000, 400876900, 401920600, 402941900, 403961700, 
		405127900, 406099400, 407017000, 407919200, 408776600, 409691100, 
		410493500, 411271500, 412100900, 412864900, 413657700, 414416300, 
		415278900, 416006600, 416729100, 417547800, 418484600, 419464300, 
		420315400, 421105900, 421842000, 422598000, 423364900, 424140400, 
		424968000, 425975600, 426849000, 427707400, 428479900, 429267300, 
		430051600, 430838100, 431598800, 432323300)), class = "data.frame", row.names = c(NA, 
		-195L))
	
	if(!cap_curve %in% c("lidar","udwr")){warning("cap_curve argument not one of 'lidar' or 'udwr'. Default 'lidar' capacity curve used.")}
	if(cap_curve=="udwr"){cap=cap_udwr} else{cap=cap_lidar}

	if(cap_curve_only){
		return(cap)	
	}else{
		page=read.csv("https://www.waterrights.utah.gov/cgi-bin/dvrtview.exe?STATION_ID=9019&RECORD_YEAR=2020&Modinfo=Daily_Comma")
		url=grep("href", page[,1], value = TRUE)[1]
		url=gsub("(txt).*", "\\1", url)
		url=gsub(".*(tmpdata)", "\\1", url)
		url=paste0("https://www.waterrights.utah.gov/",url)
		result=read.csv(file=url)
		result=result %>% dplyr::rename(gage_height=Daily.gage.height.in.FEET) %>% 
			dplyr::mutate(
				date=lubridate::make_date(year, month, day), #date format
				elevation_ft=4489.045+gage_height, #gage height to elevation (add compromise elevation to height)
				elevation_m=elevation_ft*0.3048
			)
			
		#elevation to SA & volume
		result=data.table::data.table(result)
		data.table::setkey(result, elevation_m)
		cap=data.table::data.table(cap)
		data.table::setkey(cap, stage_m)
		result=data.frame(cap[result, roll="nearest"]) %>% dplyr::rename(elevation_m=stage_m) %>% dplyr::select(date, elevation_ft, elevation_m, year, month, day, surface_area_m2, volume_m3)
		return(result)
	}
}






